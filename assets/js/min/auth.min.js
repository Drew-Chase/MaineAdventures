/* LFInteractive LLC. All Rights Reserved */
(()=>{async function r(){let r="",n="";document.cookie.split(";").forEach(e=>{try{let o=e.split("="),a=o[0].trim(),s=o[1].trim();"username"==a?r=s:"password"==a&&(n=s)}catch{}});let o=await e(r,n,!1);return{success:null==o.error,user:o}}async function e(r,e,o=!0){let a={error:"Unknown error has occurred!"};return await $.ajax({type:"POST",url:"/assets/php/includes/auth.inc.php?c=login",data:{username:r,password:e},success:async s=>{try{a=await s}catch(r){console.error(r)}n(),o&&null!=a.error&&n(a.error),document.cookie=`username=${r}; expires=${new Date(3e3,1,1).toLocaleString("GMT")}; path=/panel`,document.cookie=`password=${e}; expires=${new Date(3e3,1,1).toLocaleString("GMT")}; path=/panel`}}),a}function n(r){null==r?($("p.error").css("display","none"),$("p.error").html("")):($("p.error").css("display",""),$("p.error").html(r))}let o={};window.location.pathname.startsWith("/panel/login")||window.location.pathname.startsWith("/panel/register")?r().then(r=>{r.success&&(window.location.href="/panel/")}):r().then(r=>{r.success?(o=r.user,console.log(`Logged in as ${o.username}`),Array.from($(".username")).forEach(r=>{r.innerText=o.username})):(console.error(r),window.location.href="/panel/login")}),$("#register-form #button-panel .btn").on("click",()=>{!async function(r,o,a){if(o==a)return await $.ajax({type:"POST",url:"/assets/php/includes/auth.inc.php?c=register",data:{username:r,password:o},dataType:"json",success:async n=>{await e(r,o),window.location.href="/panel"},failure:async(r,e,o)=>{n(o)}});n("Passwords must match")}($("input#username").val(),$("input#password").val(),$("input#confirm-password").val())}),$("#login-form input").on("keydown",r=>{"Enter"==r.key&&$("#login-form .btn")[0].click()}),$("#login-form .btn").on("click",()=>{e($("#username").val(),$("#password").val()).then(r=>{null!=r.error?($("#login-form .error").css("opacity","1"),$("#login-form .error")[0].innerText=r.error):($("#login-form .error").css("opacity","0"),window.location.href="/panel")})})}).call();